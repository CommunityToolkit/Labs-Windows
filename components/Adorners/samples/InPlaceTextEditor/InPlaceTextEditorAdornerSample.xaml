<!--  Licensed to the .NET Foundation under one or more agreements. The .NET Foundation licenses this file to you under the MIT license. See the LICENSE file in the project root for more information.  -->
<Page x:Class="AdornersExperiment.Samples.InPlaceTextEditor.InPlaceTextEditorAdornerSample"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="using:AdornersExperiment.Samples.InPlaceTextEditor"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
      xmlns:ui="using:CommunityToolkit.WinUI"
      mc:Ignorable="d">

    <Page.Resources>
        <local:InPlaceTextEditorAdornerResources />
        <!-- Style copied here from above for convenience of the sample
        <Style x:Key="DefaultInPlaceTextEditorAdornerStyle"
               TargetType="local:InPlaceTextEditorAdorner">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="local:InPlaceTextEditorAdorner">
                        <ContentControl x:Name="ContentContainer"
                                        HorizontalContentAlignment="Stretch"
                                        VerticalContentAlignment="Stretch">
                            <ContentControl.ContentTemplate>
                                <DataTemplate x:DataType="local:InPlaceTextEditorAdorner">
                                    <Popup x:Name="PopupRoot"
                                           Windows11:DesiredPlacement="BottomEdgeAlignedLeft"
                                           Windows11:PlacementTarget="{x:Bind AdornedElement, Mode=OneWay}"
                                           IsLightDismissEnabled="False"
                                           IsOpen="{x:Bind IsPopupOpen, Mode=OneWay}">
                                        <Grid MinWidth="320"
                                              Margin="-4"
                                              Padding="4"
                                              Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
                                              BorderBrush="{ThemeResource SurfaceStrokeColorFlyoutBrush}"
                                              ColumnSpacing="4"
                                              CornerRadius="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBox Text="{x:Bind AdornedElement.Text, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                <interactivity:Interaction.Behaviors>
                                                    <behaviors:AutoSelectBehavior />
                                                </interactivity:Interaction.Behaviors>
                                            </TextBox>
                                            <Button Grid.Column="1"
                                                    Click="{x:Bind ConfirmButton_Click}">
                                                <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                                          Glyph="&#xE73E;" />
                                            </Button>
                                            <Button x:Name="CloseButton"
                                                    Grid.Column="2"
                                                    Click="{x:Bind CloseButton_Click}">
                                                <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                                          Glyph="&#xE711;" />
                                            </Button>
                                        </Grid>
                                    </Popup>
                                </DataTemplate>
                            </ContentControl.ContentTemplate>
                        </ContentControl>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        -->
    </Page.Resources>

    <StackPanel Spacing="8">
        <TextBlock Text="Click the editable text below to edit:" />

        <!--  We use TwoWay binding to ensure the updates from the Adorner are reflected in the ViewModel  -->
        <TextBlock Text="{x:Bind ViewModel.MyText, Mode=TwoWay}">
            <ui:AdornerLayer.Xaml>
                <!--  We set the DataContext here for our Adorner to retrieve the IEditableObject reference  -->
                <!--  Style manually set here as local to example  -->
                <local:InPlaceTextEditorAdorner EditableObject="{x:Bind ViewModel}"
                                                Style="{StaticResource DefaultInPlaceTextEditorAdornerStyle}" />
            </ui:AdornerLayer.Xaml>
        </TextBlock>
    </StackPanel>
</Page>
