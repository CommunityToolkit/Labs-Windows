<?xml version="1.0" encoding="utf-8" ?>
<!--  Licensed to the .NET Foundation under one or more agreements. The .NET Foundation licenses this file to you under the MIT license. See the LICENSE file in the project root for more information.  -->
<Page x:Class="MarkdownTextBlockExperiment.Samples.MarkdownTextBlockImageProviderSample"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:controls="using:CommunityToolkit.WinUI.Controls"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="using:MarkdownTextBlockExperiment.Samples"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
      mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Padding="16"
                    Spacing="16">
            <TextBlock Style="{StaticResource TitleTextBlockStyle}"
                       Text="IImageProvider Constraint Testing" />

            <TextBlock Foreground="{ThemeResource SystemFillColorCautionBrush}"
                       TextWrapping="Wrap">
                This sample demonstrates image constraint behavior when using a custom IImageProvider.
                The test provider returns images with specific dimensions to verify constraint logic.
            </TextBlock>

            <Border Padding="16"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8">
                <StackPanel Spacing="12">
                    <TextBlock FontWeight="SemiBold"
                               Text="Test Configuration" />

                    <StackPanel Orientation="Horizontal"
                                Spacing="16">
                        <StackPanel Spacing="4">
                            <TextBlock FontSize="12"
                                       Text="Provider Image Width:" />
                            <muxc:NumberBox x:Name="ProviderWidthBox"
                                            Maximum="2000"
                                            Minimum="10"
                                            SpinButtonPlacementMode="Compact"
                                            Value="100" />
                        </StackPanel>
                        <StackPanel Spacing="4">
                            <TextBlock FontSize="12"
                                       Text="Provider Image Height:" />
                            <muxc:NumberBox x:Name="ProviderHeightBox"
                                            Maximum="2000"
                                            Minimum="10"
                                            SpinButtonPlacementMode="Compact"
                                            Value="100" />
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Spacing="16">
                        <StackPanel Spacing="4">
                            <TextBlock FontSize="12"
                                       Text="Theme MaxWidth:" />
                            <muxc:NumberBox x:Name="ThemeMaxWidthBox"
                                            Maximum="2000"
                                            Minimum="0"
                                            SpinButtonPlacementMode="Compact"
                                            Value="500" />
                        </StackPanel>
                        <StackPanel Spacing="4">
                            <TextBlock FontSize="12"
                                       Text="Theme MaxHeight:" />
                            <muxc:NumberBox x:Name="ThemeMaxHeightBox"
                                            Maximum="2000"
                                            Minimum="0"
                                            SpinButtonPlacementMode="Compact"
                                            Value="500" />
                        </StackPanel>
                    </StackPanel>

                    <Button x:Name="ApplyButton"
                            Click="ApplyButton_Click"
                            Content="Apply and Test" />
                </StackPanel>
            </Border>

            <!--  Test Cases  -->
            <Border Padding="16"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8">
                <StackPanel Spacing="12">
                    <TextBlock FontWeight="SemiBold"
                               Text="Test Case 1: Small image, larger theme constraint" />
                    <TextBlock FontSize="12"
                               Foreground="{ThemeResource SystemFillColorNeutralBrush}"
                               TextWrapping="Wrap">
                        Expected: Image should maintain natural size (100x100), NOT be enlarged to theme constraint (500x500).
                    </TextBlock>
                    <controls:MarkdownTextBlock x:Name="TestCase1"
                                                Text="![test](provider://test1.png)" />
                    <TextBlock x:Name="TestCase1Result"
                               FontSize="12" />
                </StackPanel>
            </Border>

            <Border Padding="16"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8">
                <StackPanel Spacing="12">
                    <TextBlock FontWeight="SemiBold"
                               Text="Test Case 2: Large image (800x600), smaller theme constraint (400)" />
                    <TextBlock FontSize="12"
                               Foreground="{ThemeResource SystemFillColorNeutralBrush}"
                               TextWrapping="Wrap">
                        Expected: Image should be constrained to theme MaxWidth (400), not remain at 800.
                    </TextBlock>
                    <controls:MarkdownTextBlock x:Name="TestCase2"
                                                Text="![test](provider://test2.png)" />
                    <TextBlock x:Name="TestCase2Result"
                               FontSize="12" />
                </StackPanel>
            </Border>

            <Border Padding="16"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8">
                <StackPanel Spacing="12">
                    <TextBlock FontWeight="SemiBold"
                               Text="Test Case 3: Image with no provider dimensions (unknown natural size)" />
                    <TextBlock FontSize="12"
                               Foreground="{ThemeResource SystemFillColorNeutralBrush}"
                               TextWrapping="Wrap">
                        Expected: Image should NOT have theme constraints applied (MaxWidth should be Infinity), since we don't know if constraints would enlarge it.
                    </TextBlock>
                    <controls:MarkdownTextBlock x:Name="TestCase3"
                                                Text="![test](provider://test3-nodims.png)" />
                    <TextBlock x:Name="TestCase3Result"
                               FontSize="12" />
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
